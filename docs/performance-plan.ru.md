# План улучшения производительности

## Текущие меры
- Сетевые запросы завернуты в таймаут с аварийным завершением через 10 секунд, чтобы UI не зависал бесконечно.
- При недоступности бэкенда используется локальный контент каталога и базы знаний.
- Конфигурация React Query выносится в `createQueryClient` для единообразных настроек кеша.

## Что изменяем сейчас
1. **Статический префетч по умолчанию отключён.** Теперь флажок `VITE_ENABLE_STATIC_PREFETCH` нужно явно выставить в `true`, чтобы загрузить локальные данные заранее. Это упрощает откат: удаляем флажок — и приложение возвращается к прежней модели без мгновенной подстановки.
2. **Плейсхолдеры базы знаний показываются только для пустого поиска.** Это исключает несоответствие между локальным и серверным поиском при вводе запросов и ускоряет диагностику потенциальных багов.

## Следующие шаги
- Добавить профилировщик в dev-сборку (`React.Profiler` + отчёт в консоль) для поиска узких мест при отрисовке длинных списков.
- Оптимизировать изображения каталога: генерация версий в WebP и lazy-loading для блоков описания.
- Вынести фичи-флаги в конфигурацию Telegram-бота, чтобы переключать режимы без ребилда (через payload initData).

## Быстрый откат
- Удалите переменную `VITE_ENABLE_STATIC_PREFETCH` из `.env` — и приложение перестанет подгружать локальные данные в кеш.
- При необходимости можно удалить файл `src/lib/query-client.ts` и вернуть инициализацию клиента в `main.tsx`, чтобы полностью вернуться к предыдущей архитектуре.
